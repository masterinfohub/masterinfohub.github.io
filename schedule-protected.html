<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <title>Password Protected Page</title>
    <style>
        html, body {
            margin: 0;
            width: 100%;
            height: 100%;
            font-family: Arial, Helvetica, sans-serif;
        }
        #dialogText {
            color: white;
            background-color: #333333;
        }
        
        #dialogWrap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: table;
            background-color: #EEEEEE;
        }
        
        #dialogWrapCell {
            display: table-cell;
            text-align: center;
            vertical-align: middle;
        }
        
        #mainDialog {
            max-width: 400px;
            margin: 5px;
            border: solid #AAAAAA 1px;
            border-radius: 10px;
            box-shadow: 3px 3px 5px 3px #AAAAAA;
            margin-left: auto;
            margin-right: auto;
            background-color: #FFFFFF;
            overflow: hidden;
            text-align: left;
        }
        #mainDialog > * {
            padding: 10px 30px;
        }
        #passArea {
            padding: 20px 30px;
            background-color: white;
        }
        #passArea > * {
            margin: 5px auto;
        }
        #pass {
            width: 100%;
            height: 40px;
            font-size: 30px;
        }
        
        #messageWrapper {
            float: left;
            vertical-align: middle;
            line-height: 30px;
        }
        
        .notifyText {
            display: none;
        }
        
        #invalidPass {
            color: red;
        }
        
        #success {
            color: green;
        }
        
        #submitPass {
            font-size: 20px;
            border-radius: 5px;
            background-color: #E7E7E7;
            border: solid gray 1px;
            float: right;
            cursor: pointer;
        }
        #contentFrame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        #attribution {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            text-align: center;
            padding: 10px;
            font-weight: bold;
            font-size: 0.8em;
        }
        #attribution, #attribution a {
            color: #999;
        }
        .error {
            display: none;
            color: red;
        }
    </style>
  </head>
  <body>
    <iframe id="contentFrame" frameBorder="0" allowfullscreen></iframe>
    <div id="dialogWrap">
        <div id="dialogWrapCell">
            <div id="mainDialog">
                <div id="dialogText">This page is password protected.</div>
                <div id="passArea">
                    <p id="passwordPrompt">Password</p>
                    <input id="pass" type="password" name="pass" autofocus>
                    <div>
                        <span id="messageWrapper">
                            <span id="invalidPass" class="error">Sorry, please try again.</span>
                            <span id="trycatcherror" class="error">Sorry, something went wrong.</span>
                            <span id="success" class="notifyText">Success!</span>
                            &nbsp;
                        </span>
                        <button id="submitPass" type="button">Submit</button>
                        <div style="clear: both;"></div>
                    </div>
                </div>
                <div id="securecontext" class="error">
                    <p>
                        Sorry, but password protection only works over a secure connection. Please load this page via HTTPS.
                    </p>
                </div>
                <div id="nocrypto" class="error">
                    <p>
                        Your web browser appears to be outdated. Please visit this page using a modern browser.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div id="attribution">
        Protected by <a href="https://www.maxlaumeister.com/pagecrypt/">PageCrypt</a>
    </div>
    <script>
    (function() {

        var pl = "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";
        
        var submitPass = document.getElementById('submitPass');
        var passEl = document.getElementById('pass');
        var invalidPassEl = document.getElementById('invalidPass');
        var trycatcherror = document.getElementById('trycatcherror');
        var successEl = document.getElementById('success');
        var contentFrame = document.getElementById('contentFrame');
        
        // Sanity checks

        if (pl === "") {
            submitPass.disabled = true;
            passEl.disabled = true;
            alert("This page is meant to be used with the encryption tool. It doesn't work standalone.");
            return;
        }

        if (!isSecureContext) {
            document.querySelector("#passArea").style.display = "none";
            document.querySelector("#securecontext").style.display = "block";
            return;
        }

        if (!crypto.subtle) {
            document.querySelector("#passArea").style.display = "none";
            document.querySelector("#nocrypto").style.display = "block";
            return;
        }
        
        function str2ab(str) {
            var ustr = atob(str);
            var buf = new ArrayBuffer(ustr.length);
            var bufView = new Uint8Array(buf);
            for (var i=0, strLen=ustr.length; i < strLen; i++) {
                bufView[i] = ustr.charCodeAt(i);
            }
            return bufView;
        }

        async function deriveKey(salt, password) {
            const encoder = new TextEncoder()
            const baseKey = await crypto.subtle.importKey(
                'raw',
                encoder.encode(password),
                'PBKDF2',
                false,
                ['deriveKey'],
            )
            return await crypto.subtle.deriveKey(
                { name: 'PBKDF2', salt, iterations: 100000, hash: 'SHA-256' },
                baseKey,
                { name: 'AES-GCM', length: 256 },
                true,
                ['decrypt'],
            )
        }
        
        async function doSubmit(evt) {
            submitPass.disabled = true;
            passEl.disabled = true;

            let iv, ciphertext, key;
            
            try {
                var unencodedPl = str2ab(pl);

                const salt = unencodedPl.slice(0, 32)
                iv = unencodedPl.slice(32, 32 + 16)
                ciphertext = unencodedPl.slice(32 + 16)

                key = await deriveKey(salt, passEl.value);
            } catch (e) {
                trycatcherror.style.display = "inline";
                console.error(e);
                return;
            }

            try {
                const decryptedArray = new Uint8Array(
                    await crypto.subtle.decrypt({ name: 'AES-GCM', iv }, key, ciphertext)
                );

                let decrypted = new TextDecoder().decode(decryptedArray);

                if (decrypted === "") throw "No data returned";

                const basestr = '<base href="." target="_top">';
                const anchorfixstr = `
                    <script>
                        Array.from(document.links).forEach((anchor) => {
                            const href = anchor.getAttribute("href");
                            if (href.startsWith("#")) {
                                anchor.addEventListener("click", function(e) {
                                    e.preventDefault();
                                    const targetId = this.getAttribute("href").substring(1);
                                    const targetEl = document.getElementById(targetId);
                                    targetEl.scrollIntoView();
                                });
                            }
                        });
                    <\/script>
                `;
                
                // Set default iframe link targets to _top so all links break out of the iframe
                if (decrypted.includes("<head>")) decrypted = decrypted.replace("<head>", "<head>" + basestr);
                else if (decrypted.includes("<!DOCTYPE html>")) decrypted = decrypted.replace("<!DOCTYPE html>", "<!DOCTYPE html>" + basestr);
                else decrypted = basestr + decrypted;

                // Fix fragment links
                if (decrypted.includes("</body>")) decrypted = decrypted.replace("</body>", anchorfixstr + '</body>');
                else if (decrypted.includes("</html>")) decrypted = decrypted.replace("</html>", anchorfixstr + '</html>');
                else decrypted = decrypted + anchorfixstr;
                
                contentFrame.srcdoc = decrypted;
                
                successEl.style.display = "inline";
                setTimeout(function() {
                    dialogWrap.style.display = "none";
                }, 1000);
            } catch (e) {
                invalidPassEl.style.display = "inline";
                passEl.value = "";
                submitPass.disabled = false;
                passEl.disabled = false;
                console.error(e);
                return;
            }
        }
        
        submitPass.onclick = doSubmit;
        passEl.onkeypress = function(e){
            if (!e) e = window.event;
            var keyCode = e.keyCode || e.which;
            invalidPassEl.style.display = "none";
            if (keyCode == '13'){
              // Enter pressed
              doSubmit();
              return false;
            }
        }
    })();
    </script>
  </body>
</html>
