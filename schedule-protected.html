<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow">
    <title>Password Protected Page</title>
    <style>
        html, body {
            margin: 0;
            width: 100%;
            height: 100%;
            font-family: Arial, Helvetica, sans-serif;
        }
        #dialogText {
            color: white;
            background-color: #333333;
        }
        
        #dialogWrap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: table;
            background-color: #EEEEEE;
        }
        
        #dialogWrapCell {
            display: table-cell;
            text-align: center;
            vertical-align: middle;
        }
        
        #mainDialog {
            max-width: 400px;
            margin: 5px;
            border: solid #AAAAAA 1px;
            border-radius: 10px;
            box-shadow: 3px 3px 5px 3px #AAAAAA;
            margin-left: auto;
            margin-right: auto;
            background-color: #FFFFFF;
            overflow: hidden;
            text-align: left;
        }
        #mainDialog > * {
            padding: 10px 30px;
        }
        #passArea {
            padding: 20px 30px;
            background-color: white;
        }
        #passArea > * {
            margin: 5px auto;
        }
        #pass {
            width: 100%;
            height: 40px;
            font-size: 30px;
        }
        
        #messageWrapper {
            float: left;
            vertical-align: middle;
            line-height: 30px;
        }
        
        .notifyText {
            display: none;
        }
        
        #invalidPass {
            color: red;
        }
        
        #success {
            color: green;
        }
        
        #submitPass {
            font-size: 20px;
            border-radius: 5px;
            background-color: #E7E7E7;
            border: solid gray 1px;
            float: right;
            cursor: pointer;
        }
        #contentFrame {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        #attribution {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            text-align: center;
            padding: 10px;
            font-weight: bold;
            font-size: 0.8em;
        }
        #attribution, #attribution a {
            color: #999;
        }
        .error {
            display: none;
            color: red;
        }
    </style>
  </head>
  <body>
    <iframe id="contentFrame" frameBorder="0" allowfullscreen></iframe>
    <div id="dialogWrap">
        <div id="dialogWrapCell">
            <div id="mainDialog">
                <div id="dialogText">This page is password protected.</div>
                <div id="passArea">
                    <p id="passwordPrompt">Password</p>
                    <input id="pass" type="password" name="pass" autofocus>
                    <div>
                        <span id="messageWrapper">
                            <span id="invalidPass" class="error">Sorry, please try again.</span>
                            <span id="trycatcherror" class="error">Sorry, something went wrong.</span>
                            <span id="success" class="notifyText">Success!</span>
                            &nbsp;
                        </span>
                        <button id="submitPass" type="button">Submit</button>
                        <div style="clear: both;"></div>
                    </div>
                </div>
                <div id="securecontext" class="error">
                    <p>
                        Sorry, but password protection only works over a secure connection. Please load this page via HTTPS.
                    </p>
                </div>
                <div id="nocrypto" class="error">
                    <p>
                        Your web browser appears to be outdated. Please visit this page using a modern browser.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <div id="attribution">
        Protected by <a href="https://www.maxlaumeister.com/pagecrypt/">PageCrypt</a>
    </div>
    <script>
    (function() {

        var pl = "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";
        
        var submitPass = document.getElementById('submitPass');
        var passEl = document.getElementById('pass');
        var invalidPassEl = document.getElementById('invalidPass');
        var trycatcherror = document.getElementById('trycatcherror');
        var successEl = document.getElementById('success');
        var contentFrame = document.getElementById('contentFrame');
        
        // Sanity checks

        if (pl === "") {
            submitPass.disabled = true;
            passEl.disabled = true;
            alert("This page is meant to be used with the encryption tool. It doesn't work standalone.");
            return;
        }

        if (!isSecureContext) {
            document.querySelector("#passArea").style.display = "none";
            document.querySelector("#securecontext").style.display = "block";
            return;
        }

        if (!crypto.subtle) {
            document.querySelector("#passArea").style.display = "none";
            document.querySelector("#nocrypto").style.display = "block";
            return;
        }
        
        function str2ab(str) {
            var ustr = atob(str);
            var buf = new ArrayBuffer(ustr.length);
            var bufView = new Uint8Array(buf);
            for (var i=0, strLen=ustr.length; i < strLen; i++) {
                bufView[i] = ustr.charCodeAt(i);
            }
            return bufView;
        }

        async function deriveKey(salt, password) {
            const encoder = new TextEncoder()
            const baseKey = await crypto.subtle.importKey(
                'raw',
                encoder.encode(password),
                'PBKDF2',
                false,
                ['deriveKey'],
            )
            return await crypto.subtle.deriveKey(
                { name: 'PBKDF2', salt, iterations: 100000, hash: 'SHA-256' },
                baseKey,
                { name: 'AES-GCM', length: 256 },
                true,
                ['decrypt'],
            )
        }
        
        async function doSubmit(evt) {
            submitPass.disabled = true;
            passEl.disabled = true;

            let iv, ciphertext, key;
            
            try {
                var unencodedPl = str2ab(pl);

                const salt = unencodedPl.slice(0, 32)
                iv = unencodedPl.slice(32, 32 + 16)
                ciphertext = unencodedPl.slice(32 + 16)

                key = await deriveKey(salt, passEl.value);
            } catch (e) {
                trycatcherror.style.display = "inline";
                console.error(e);
                return;
            }

            try {
                const decryptedArray = new Uint8Array(
                    await crypto.subtle.decrypt({ name: 'AES-GCM', iv }, key, ciphertext)
                );

                let decrypted = new TextDecoder().decode(decryptedArray);

                if (decrypted === "") throw "No data returned";

                const basestr = '<base href="." target="_top">';
                const anchorfixstr = `
                    <script>
                        Array.from(document.links).forEach((anchor) => {
                            const href = anchor.getAttribute("href");
                            if (href.startsWith("#")) {
                                anchor.addEventListener("click", function(e) {
                                    e.preventDefault();
                                    const targetId = this.getAttribute("href").substring(1);
                                    const targetEl = document.getElementById(targetId);
                                    targetEl.scrollIntoView();
                                });
                            }
                        });
                    <\/script>
                `;
                
                // Set default iframe link targets to _top so all links break out of the iframe
                if (decrypted.includes("<head>")) decrypted = decrypted.replace("<head>", "<head>" + basestr);
                else if (decrypted.includes("<!DOCTYPE html>")) decrypted = decrypted.replace("<!DOCTYPE html>", "<!DOCTYPE html>" + basestr);
                else decrypted = basestr + decrypted;

                // Fix fragment links
                if (decrypted.includes("</body>")) decrypted = decrypted.replace("</body>", anchorfixstr + '</body>');
                else if (decrypted.includes("</html>")) decrypted = decrypted.replace("</html>", anchorfixstr + '</html>');
                else decrypted = decrypted + anchorfixstr;
                
                contentFrame.srcdoc = decrypted;
                
                successEl.style.display = "inline";
                setTimeout(function() {
                    dialogWrap.style.display = "none";
                }, 1000);
            } catch (e) {
                invalidPassEl.style.display = "inline";
                passEl.value = "";
                submitPass.disabled = false;
                passEl.disabled = false;
                console.error(e);
                return;
            }
        }
        
        submitPass.onclick = doSubmit;
        passEl.onkeypress = function(e){
            if (!e) e = window.event;
            var keyCode = e.keyCode || e.which;
            invalidPassEl.style.display = "none";
            if (keyCode == '13'){
              // Enter pressed
              doSubmit();
              return false;
            }
        }
    })();
    </script>
  </body>
</html>
